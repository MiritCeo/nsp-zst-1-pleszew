import{z as F,r as P,A as B,o as d,c as f,a as p,b as o,u as e,H as C,d as t,L as z,e as w,f as L,k as h,F as M,B as T,h as g,K as H,M as I}from"./app.b53879ed.js";import{a as N,_ as b}from"./PrimaryButton.27dfc493.js";import{_}from"./InputError.78c0204c.js";import{s as W}from"./inputnumber.esm.05772400.js";import{s as k}from"./calendar.esm.12e8c0b5.js";import{s as x,a as A,b as Y,c as O}from"./chip.esm.b5f11390.js";import{s as K}from"./toast.esm.607cb02c.js";import{h as R}from"./moment.9709ab41.js";import{U as Z}from"./UserLayout.2bbc437d.js";import"./inputtext.esm.b0b1c258.js";import"./button.esm.3c05891c.js";import"./portal.esm.e4d18dea.js";const n=m=>(H("data-v-fdb4edc2"),m=m(),I(),m),q=["onSubmit"],G={class:"flex justify-between"},J=n(()=>t("div",{class:"pi pi-home"},null,-1)),Q=g(" Powr\xF3t "),X=n(()=>t("div",{class:"pi pi-trash"},null,-1)),ee=g(" Usu\u0144 "),se={class:"mb-4 grid grid-cols-1 gap-3 flex-wrap md:grid-cols-3"},te={class:"flex flex-col"},oe=n(()=>t("label",{class:"mb-2 font-semibold"},"Dzie\u0144",-1)),ae={class:"flex flex-col"},re=n(()=>t("label",{class:"mb-2 font-semibold"},"Pocz\u0105tek",-1)),le={class:"flex flex-col"},ie=n(()=>t("label",{class:"mb-2 font-semibold"},"Koniec",-1)),de={class:"mb-4 grid grid-cols-1 gap-3 md:grid-cols-3"},ne={class:"flex flex-col"},me=n(()=>t("label",{class:"mb-2 font-semibold"},"Projekt",-1)),ce={class:"flex flex-col"},ue=n(()=>t("label",{class:"mb-2 font-semibold"},"Rodzaj pracy",-1)),pe={class:"flex flex-col"},_e=n(()=>t("label",{class:"mb-2 font-semibold w-min-0"},"Ilo\u015B\u0107 godzin",-1)),fe={class:"grid col-span-3"},he=n(()=>t("label",{for:"end",class:"mb-2 font-semibold"},"Opis",-1)),be=["onClick"],ge={class:"flex justify-center flex-wrap md:justify-between"},ye={class:"mb-2 w-full md:w-auto"},we=g(" Dodaj czynno\u015B\u0107 "),ke={class:"w-full md:w-auto"},Ve=g(" Zapisz formularz "),ve={__name:"Edit",props:{work_types:Array,projects:Array,timestamp:Array},setup(m){const i=m,V=new Date(i.timestamp.start_time);V.getHours();const v=new Date(i.timestamp.end_time);v.getHours();const j=F(),D=P(!1),y=new Date;y.setDate(y.getDate()+60);const s=B({day:new Date(i.timestamp.day),start_time:V,end_time:v,fields:[{work_type:i.timestamp.entries[0].work_type_id,project:i.timestamp.entries[0].project_id,working_hours:i.timestamp.entries[0].working_hours,description:i.timestamp.entries[0].description}]});function U(r){return r+1}i.timestamp.entries.forEach((r,l)=>{l!=0&&s.fields.push({work_type:r.work_type.id,project:r.project.id,working_hours:r.working_hours,description:r.description})});function $(){s.fields.push({work_type:null,project:null,working_hours:null,description:null})}function E(r){s.fields.length>1&&s.fields.splice(r,1)}const S=()=>{s.put(route("update.timebox",R(i.timestamp.day).format("DD-MM-YYYY")),{onStart:()=>{s.clearErrors()},onSuccess:()=>{j.add({severity:"success",summary:"Powodzenie",detail:"Formularz zapisany",life:3e3})},onError:r=>{s.setError("day",r.day),j.add({severity:"error",summary:"B\u0142\u0105d",detail:"Wyst\u0105pi\u0142 b\u0142\u0105d podczas zapisu formularza",life:3e3})}})};return(r,l)=>(d(),f(Z,null,{default:p(()=>[o(e(K)),o(e(C),{title:"Edit"}),t("form",{onSubmit:T(S,["prevent"])},[t("div",G,[o(e(z),{class:"text-sm",href:r.route("home"),method:"get",as:"button"},{default:p(()=>[o(b,{class:"mb-3 bg-indigo-500 hover:bg-indigo-600 active:bg-indigo-500 focus:border-indigo-600"},{default:p(()=>[J,Q]),_:1})]),_:1},8,["href"]),o(e(z),{class:"text-sm",href:r.route("delete.timebox",m.timestamp),as:"button",method:"DELETE"},{default:p(()=>[o(b,{class:"mb-3 bg-red-500 hover:bg-red-600 active:bg-red-500 focus:border-red-600"},{default:p(()=>[X,ee]),_:1})]),_:1},8,["href"])]),t("div",se,[t("div",te,[oe,o(e(k),{modelValue:e(s).day,"onUpdate:modelValue":l[0]||(l[0]=a=>e(s).day=a),showTime:!1,maxDate:e(y),dateFormat:"dd-mm-yy",disabled:""},null,8,["modelValue","maxDate"]),o(_,{class:"mt-2",message:e(s).errors.day},null,8,["message"])]),t("div",ae,[re,o(e(k),{modelValue:e(s).start_time,"onUpdate:modelValue":l[1]||(l[1]=a=>e(s).start_time=a),stepMinute:15,showTime:!0,timeOnly:!0,maxDate:e(s).end_time},null,8,["modelValue","maxDate"]),o(_,{class:"mt-2",message:e(s).errors.start_time},null,8,["message"])]),t("div",le,[ie,o(e(k),{modelValue:e(s).end_time,"onUpdate:modelValue":l[2]||(l[2]=a=>e(s).end_time=a),stepMinute:15,showTime:!0,timeOnly:!0,minDate:e(s).start_time},null,8,["modelValue","minDate"]),o(_,{class:"mt-2",message:e(s).errors.end_time},null,8,["message"])])]),(d(!0),w(M,null,L(e(s).fields,(a,c)=>(d(),w("div",{key:c},[t("div",de,[t("div",ne,[me,o(e(x),{modelValue:a.project,"onUpdate:modelValue":u=>a.project=u,options:m.projects,optionValue:"id",optionLabel:"name",placeholder:"Wybierz projekt",filter:!0,filterPlaceholder:"Szukaj projektu",showClear:!0},null,8,["modelValue","onUpdate:modelValue","options"]),e(s).errors?(d(),f(_,{key:0,class:"mt-2",message:e(s).errors[`fields.${c}.project`]},null,8,["message"])):h("",!0)]),t("div",ce,[ue,o(e(x),{modelValue:a.work_type,"onUpdate:modelValue":u=>a.work_type=u,options:m.work_types,optionValue:"id",optionLabel:"name",placeholder:"Wybierz tryb pracy",filter:!0,filterPlaceholder:"Szukaj trybu pracy",showClear:!0},null,8,["modelValue","onUpdate:modelValue","options"]),e(s).errors?(d(),f(_,{key:0,class:"mt-2",message:e(s).errors[`fields.${c}.work_type`]},null,8,["message"])):h("",!0)]),t("div",pe,[_e,o(e(W),{modelValue:a.working_hours,"onUpdate:modelValue":u=>a.working_hours=u,maxFractionDigits:2,showButtons:"",step:.25,placeholder:"Wpisz ilo\u015B\u0107 godzin w projekcie"},null,8,["modelValue","onUpdate:modelValue","step"]),e(s).errors?(d(),f(_,{key:0,class:"mt-2",message:e(s).errors[`fields.${c}.working_hours`]},null,8,["message"])):h("",!0),D.value?(d(),f(_,{key:1,class:"mt-2",message:"Wyst\u0105pi\u0142 b\u0142\u0105d, przelicz ponownie godziny"})):h("",!0)])]),t("div",fe,[he,o(e(A),{modelValue:a.description,"onUpdate:modelValue":u=>a.description=u,autoResize:!0,maxlength:"255",rows:"1",placeholder:"Dodaj opcjonalny opis czynno\u015Bci w projekcie"},null,8,["modelValue","onUpdate:modelValue"]),e(s).errors?(d(),f(_,{key:0,class:"mt-2",message:e(s).errors[`fields.${c}.description`]},null,8,["message"])):h("",!0),c!=0?(d(),w("i",{key:1,class:"pi pi-trash cursor-pointer mt-4 mb-0 mx-auto",style:{"font-size":"2rem",color:"#e60000"},onClick:u=>E(c)},null,8,be)):h("",!0)]),o(e(O),{class:"mb-4 grid col-span-3",align:"center",type:"solid"},{default:p(()=>[o(e(Y),{label:"Projekt "+U(c),class:"custom-chip"},null,8,["label"])]),_:2},1024)]))),128)),t("div",ge,[t("div",ye,[o(b,{class:"w-full",type:"button",onClick:l[3]||(l[3]=a=>$())},{default:p(()=>[we]),_:1})]),t("div",ke,[o(b,{class:"w-full",disabled:e(s).processing},{default:p(()=>[Ve]),_:1},8,["disabled"])])])],40,q)]),_:1}))}},Me=N(ve,[["__scopeId","data-v-fdb4edc2"]]);export{Me as default};
